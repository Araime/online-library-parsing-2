# Парсер книг с сайта tululu.org Часть - 2

Консольное приложение для скачивания книг в жанре фантастика. В отличие от 
[предыдущей версии](https://github.com/Araime/online-library-parsing), можно 
указывать диапазон страниц с книгами, одна страница - 25 книг. Приложение скачивает
все доступные для скачивания книги, их обложки, а также создает файл `books_description.json`,
куда заносится всё подробное описание  к каждой книге. Для скачивания приложение 
создает три папки `books`, `images`, `json`, необходимые для хранения скачанного 
контента.

### Как установить

#### Скачать

Python3 должен быть уже установлен. Скачать этот репозиторий себе на компьютер.

Рекомендуется использовать [virtualenv/venv](https://docs.python.org/3/library/venv.html)
для изоляции проекта.

#### Быстрая настройка venv

Начиная с Python версии 3.3 виртуальное окружение идёт в комплекте в виде модуля
venv. Чтобы его установить и активировать нужно выполнить следующие действия в
командной строке:  

Указать скачанный репозиторий в качестве каталога.
```sh
cd C:\Users\ваш_пользователь\Downloads\папка_репозитория
```
Установить виртуальное окружение в выбранном каталоге.
```sh
Python -m venv env
```
В репозитории появится папка виртуального окружения env  

<a href="https://imgbb.com/"><img src="https://i.ibb.co/Hn4C6PD/image.png" alt="image" border="0"></a>

Активировать виртуальное окружение.
```sh
env\scripts\activate
```
Если всё сделано правильно, вы увидите в командной строке (env) слева от пути 
каталога.  

<a href="https://imgbb.com/"><img src="https://i.ibb.co/MZ72r22/2.png" alt="2" border="0"></a>

#### Установить зависимости

Используйте `pip` (или `pip3`, есть конфликт с Python2) для установки 
зависимостей:

```sh
pip install -r requirements.txt
```

### Как использовать

Если не указывать никаких аргументов, приложение скачивает все доступные книги с первой
до последней страницы. Если указать только начальную страницу, приложение скачивает доступные книги
с указанной страницы.

При запуске скрипта приложение проверит, есть ли в корневом каталоге папки
`books`, `images` и `json`, создаёт их(по умолчанию в корне репозитория) при 
необходимости и скачивает в них книги, обложки и подробное описание к каждой 
книге. К названиям книг и обложек добавляется текущие дата и время.

Для запуска приложение принимает два необязательных аргумента:
  1. `--start_page` или `-s` - указывает с какой страницы начать скачивание книг
     (по умолчанию значение = 1)
  1. `--end_page` или `-e` - до какой страницы скачивать книги
     (если не указать номер, скачиваются все страницы, по умолчанию = 701)
  1. `--skip_img` или `-si` - не скачивать обложки книг
  1. `--skip_txt` или `-st` - не скачивать книги
  1. `--dest_folder` или `-d` - выбрать другую директорию для хранения файлов, в ней
     создадутся папки `books`, `images` и `json`.
  1. `--json_path` или `-j` выбрать отдельную директорию для хранения фала `books_description.json`

Пример запуска с указанием диапазона страниц(книги скачиваются с 1 по 4 страницу):
```sh
python parse_tululu_category.py main.py -s 1 -e 5
```
Скачиваем только седьмую страницу:
```sh
python parse_tululu_category.py main.py -s 7 -e 8
```
Не скачиваем обложки книг:
```sh
python parse_tululu_category.py main.py -si
```
Не скачиваем книги:
```sh
python parse_tululu_category.py main.py -st
```
Указываем страницы с 5 по 8, не скачиваем обложки, указываем директорию по выбору:
```sh
python parse_tululu_category.py -s 5 -e 9 -si -d "C:\Users\Пользователь\Desktop\Новая папка (2)"
```
(Внимание! Если указываете полный путь и в нем есть пробелы, обязательно оберните 
аргумент в обычные "" кавычки.)  

Указываем свой путь для `books_description.json`
```sh
python parse_tululu_category.py -j "G:\For json"
```
Все аргументы:
```sh
python parse_tululu_category.py -s 2 -e 5 -si -st -d "G:\Data" -j "G:\For json"
```

C:\Users\varfolomeyfever\Desktop\For json


Прогресс бар отображает скачивание книг:  

<a href="https://ibb.co/jR4pbS5"><img src="https://i.ibb.co/WtKTGL3/2.png" alt="2" border="0"></a>

#### Ведение логов

Если приложение доходит до последней указанной страницы и список ссылок на книги 
не пуст, приложение переходит к процессу скачивания книг.

Если список пуст, работа приложения останавливается.

Если по какому-то id-страницы книга недоступна для скачивания, то приложение продолжает 
скачивание следующей книги. Создаётся файл `sample.log`, куда записываются сообщения 
о невозможности скачать книгу с указанием ссылки на страницу книги.

### Цель проекта

Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [dvmn.org](https://dvmn.org).